\section{MTW}\label{MTW+}


The Proposition~\ref{MTW-plus-convexity} below provides the equivalence of properties (\textit{\ref{thm:convexity:convexity}}) and (\textit{\ref{thm:convexity:MTW}}) which finished the proof Theorem~\ref{thm:convexity}.
The equivalence is proved by calculations along the same lines as in \cite[Chapter 12]{villani}.

Let us introduce notations and use them to reformulate the property (\textit{\ref{thm:convexity:MTW}}).

\parbf{Tangent vectors.}
Let $M$ be a Riemannian manifold, $p\in M$.
Denote by $\IL_p$ the \emph{inner locus} of $p$; it can be defined as the $\exp_p$-image of $\TIL_p$ or, equivalently, as the complement $M\backslash \CL_p$, where $\CL_p$ denotes the cut locus of $p$.
Note that $q\in\IL_p$ if and only if $p\in \IL_p$.

Assume $q\in\IL_p$; that is, $q=\exp_pW$ for some $W\zz\in \TIL_p M$.
Given a vector $Y\in T_q$, consider the unique vector $Y_p\in\T_p$ such that 
\[Y=(d_W\exp_p)Y_p.\]

Note that $p=\exp_q(-W_q)$ if $p$, $q$ and $W$ are as above.

Given $x\in\IL_p$ such that $x=\exp_pX$ for some  $X\in \TIL_p$,  set
\[\tilde Y_p(x)=(d_X\exp_p) Y_p;\]
this way we defined a vector field $\tilde Y_p$ in $\IL_p$.

Note that in the vector field $\tilde Y_p$ is constant in the normal coordinates at $p$;
in particular 
\[\nabla_X\tilde Y_p=0\eqlbl{eq:zero}\] 
for any $X\in\T_p$.
Further, note that 
\[Y\tilde Y_pf=Y\tilde Y_qf+(\nabla_Y\tilde Y_p)f\eqlbl{eq:nabla}\]
for $Y\in \T_q$ and any smooth function $f$.
Indeed applying \ref{eq:zero}, we get that
\begin{align*}
(Y\tilde Y_p-Y\tilde Y_q)f
&=(\tilde Y_q\tilde Y_p-\tilde Y_p\tilde Y_q)f(q)=
\\
&=(\nabla_Y \tilde Y_p-\nabla_Y\tilde Y_q)f=\nabla_Y \tilde Y_pf.
\end{align*}


\parbf{Column notation.} Given two points $p$ and $q$ in a Riemannian manifold $M$,
let us define the cost function $(p,q)\mapsto \cost{p}{q}$ as
\[\dcost{}{}{p}{q}=\tfrac12\cdot|p-q|^2_M\]
We will need to differentiate the cost function by both argument.
In order to avoid possible confusion, we will write the vector next to the differentiated argument. 
For example
\[\dcost{X}{Y}{p}{q}\]
is the second mixed derivative of the cost function at the pair $(p,q)$, once by the first argument ($p$) along the vector $X \in \T_p$ and once by the second argument ($q$) along the vector field $Y\in \T_q$.
We may also write a vector field instead of the vectors.

Using the introduced notations,
we can reformulate the property (\textit{\ref{thm:convexity:MTW}}) in Theorem~\ref{thm:convexity}
as

\begin{itemize}
 \item[\textit{(ii)}$'$] \emph{If $X\in \T_p$, $Y\in\T_q$ and $q\in \IL_p$, then
 \[\dcost{X\tilde X_p}{Y\tilde Y_p}{p}{q}\le 0.\]}
\end{itemize}

The left hand side of the last inequality, multiplied by $(-\tfrac32)$ is called \emph{MTW-curvature} or \emph{cost-curvature}; it is denoted by $\mathfrak{S}(X,Y)$, see \cite[equation 12.21]{villani};
if $p=q$, then $\mathfrak{S}(X,Y)$ coincides with the curvature $\langle\Rm(X,Y)Y,X\rangle$, see \cite[12.30]{villani}.
In particular, if the condition (\textit{\ref{thm:convexity:MTW}}) holds, then the manifold has nonnegative sectional curvature. 


Assume $q=\exp_pW$ for some $W\in\TIL_p$. 
Then 
\[\dcost{X}{{}}{p}{q}=-\langle X,W\rangle;\eqlbl{derX}\]
\[\dcost{X}{Y}{p}{q}=-\langle X,Y_p\rangle =-\langle X_q,Y\rangle\eqlbl{derXY}\]
and
\[\dcost{X}{Y\tilde Y_p}{p}{q}=0.\eqlbl{derXYY}\]

Indeed, \ref{derX} is equivalent to the first variation formula.
Taking the derivative of \ref{derX} in the normal coordinates at $p$ we get \ref{derXY}.
\[\dcost{X}{Y}{p}{q}=-\langle X,Y_p\rangle.\]
Since $q\in \IL_p$ if and only if $p\in\IL_q$ we can swap $p$ and $q$ and get the second identity in \ref{derXY}. Finally, the value $\langle X,Y_p\rangle$ does not depend on $q$; therefore the derivative along the second argument \ref{derXY} has to vanish;
hence \ref{derXYY} follows.

Let us use the identities to show that 
\[\dcost{X\tilde X_p}{Y\tilde Y_p}{p}{q}=\dcost{X\tilde X_p}{Y\tilde Y_p}{p}{q}
\quad
\text{or, equivalently}
\quad
\mathfrak{S}(X,Y)=\mathfrak{S}(Y,X).\eqlbl{derXXYY}\]
This identity will not be used in the sequel, but it might help the reader to adapt to the column notation.

Applying \ref{eq:nabla}, we get that
\begin{align*}
\dcost{X\tilde X_p}{Y\tilde Y_p}{p}{q}&=\dcost{X\tilde X_p}{Y\tilde Y_q}{p}{q}+\dcost{X\tilde X_p}{\nabla_Y\tilde Y_q}{p}{q}=
\\
&=\dcost{X\tilde X_p}{Y\tilde Y_q}{p}{q}+\dcost{X\tilde X_q}{\nabla_Y\tilde Y_q}{p}{q}-\dcost{\nabla_X\tilde X_p}{\nabla_Y\tilde Y_q}{p}{q}
\end{align*}
By \ref{derXYY}, 
\[\dcost{X\tilde X_q}{\nabla_Y\tilde Y_q}{p}{q}=0.\]
Therefore
\[\dcost{X\tilde X_p}{Y\tilde Y_p}{p}{q}=\dcost{X\tilde X_p}{Y\tilde Y_q}{p}{q}-\dcost{\nabla_X\tilde X_p}{\nabla_Y\tilde Y_q}{p}{q}.\]
The right hand side is symmetric in $p$ and $q$;
hence \ref{derXXYY} follows.

\begin{thm}{Proposition}\label{MTW-plus-convexity}
Let $M$ be a CTIL Riemannian manifold.
Then the following conditions are equivalent:
\begin{enumerate}[(a)]
 \item\label{MTW-plus-convexity:MTW} For any $p\in M$, $q\in \IL_p$, $X\in \T_p$ and $Y\in\T_q$ we have
 \[\dcost{X\tilde X_p}{Y\tilde Y_p}{p}{q}\le 0.\]
 \item\label{MTW-plus-convexity:h} For any $p_0,p_1\in M$, the function $h\:\TIL_{p_0}\to\RR$ defined by
\[h(X)=\cost{{p_1}}{\exp_{p_0}X}-\cost{{p_0}}{\exp_{p_0}X}\]
is concave;
 \item\label{MTW-plus-convexity:f}  For any $p_0,p_1\in M$, the function $f\:\TIL_{p_0}\to\RR$ defined by
\[f(X)=\cost{p_1}{\exp_{p_0}X}\]
is 1-concave.
\end{enumerate}
\end{thm}

\parit{Proof.} Note that $s(X)=\tfrac12\cdot |X|^2=\cost{p}{\exp_qX}$,
in particular the function $s$ is $1$-affine (that is $1$-concave and $1$-convex at the same time).

Evidently $f=h+s$, therefore (\textit{\ref{MTW-plus-convexity:h}})$\iff$(\textit{\ref{MTW-plus-convexity:f}}).



\parit{(\ref{MTW-plus-convexity:MTW}) $\Rightarrow$ (\ref{MTW-plus-convexity:h}).}
Note that the function $h$ is semiconcave.
Therefore $h$ is concave if
\[\tfrac{d^2}{dt^2}h(U+t\cdot V)\le 0\]
at $t=0$ for almost all vectors $U\in\TIL_p$ and $V\in \T_p$.

Using the column notation, we can rewrite the inequality in the following equivalent form:
\[
\begin{matrix}{{}}\\{Y\tilde Y_{p_0}}
\end{matrix}
\left(\dcost{}{}{p_1}{q}-\dcost{}{}{p_0}{q}\right)\le 0\eqlbl{eq:MTW-plus}\]
for any $p_0,p_1, q$ and $Y\in \T_q$;
from above it is sufficient to prove \ref{eq:MTW-plus} for almost all $q$; in particular, we can assume that $p_0,p_1\in \IL_q$.

Let $W, X\in \TIL_q$ be such that $p_0=\exp_qW$, $p_1=\exp_q(W+X)$.
Since $M$ is CTIL, $W+t\cdot X\in\TIL_q$ for any $t\in[0,1]$;
set $p_t=\exp_q(W+t\cdot X)$.


Let us use the identity
$f(1)-f(0)-f'(0)=\int_0^1f''(t)\cdot(1-t)\cdot dt$,
for the function 
\[f(t)=\dcost{}{Y\tilde Y_{q}}{p_t}{q};\]
Note that
\[f'(0)=\dcost{X}{Y\tilde Y_{q}}{p_0}{q}
\quad
\text{and}
\quad 
f''(t)
=\dcost{\tilde X_{q}\tilde X_{q}}{Y\tilde Y_{q}}{p_t}{q},\]
therefore
\[\dcost{}{Y\tilde Y_{q}}{p_1}{q}-\dcost{}{Y\tilde Y_{q}}{p_0}{q}-\dcost{X}{Y\tilde Y_{q}}{p_0}{q}=\int_0^1 \dcost{\tilde X_{q}\tilde X_{q}}{Y\tilde Y_{q}}{p_t}{q}\cdot dt.\]

By (\textit{\ref{MTW-plus-convexity:MTW}}), the term under the integral is nonpositive; therefore
\[
\dcost{{}}{Y\tilde Y_{q}}{}{}
\left(\dcost{}{}{p_1}{q}-\dcost{}{}{p_0}{q}\right)
\le
\dcost{X}{Y\tilde Y_{q}}{p_0}{q}.\]
By \ref{eq:nabla}, we can rewrite the last inequality the following way:
\[
\dcost{{}}{Y\tilde Y_{p_0}}{}{}
\left(\dcost{}{}{p_1}{q}-\dcost{}{}{p_0}{q}\right)
\le
\dcost{{}}{\nabla_Y \tilde Y_{p_0}}{}{}
\left(\dcost{}{}{p_1}{q}
-
\dcost{}{}{p_0}{q}\right)
+
\dcost{X}{Y\tilde Y_{q}}{p_0}{q}.
\eqlbl{eq:MTW-plus-extra}\]

Applying \ref{derX}, we get that
\begin{align*}
\dcost{{}}{\nabla_Y \tilde Y_{p_0}}{}{}
\left(\dcost{}{}{p_1}{q}
-
\dcost{}{}{p_0}{q}\right)
&=
-\langle\nabla_Y \tilde Y_{p_0},W+X\rangle + \langle\nabla_Y \tilde Y_{p_0},W\rangle
=
\\
&=-\langle\nabla_Y \tilde Y_{p_0},X\rangle.
\end{align*}
Further, applying \ref{derXYY} and \ref{derXY}, we get that
\begin{align*}
\dcost{X}{Y\tilde Y_{q}}{p_0}{q}
&=
\dcost{X}{Y\tilde Y_{p_0}}{p_0}{q}-\dcost{X}{\nabla_Y\tilde Y_{p_0}}{p_0}{q}=
\\
&=0+\langle\nabla_Y \tilde Y_{p_0},X\rangle.
\end{align*}
It follows that the right hand side in \ref{eq:MTW-plus-extra} vanishes;
hence \ref{eq:MTW-plus} follows.

\parit{(\ref{MTW-plus-convexity:h}) $\Rightarrow$ (\ref{MTW-plus-convexity:MTW}).}
Let $p_t$, $q$, $W$, $X$ and $Y$ be as above;
set 
\[h_t(Z)=\cost{{p_t}}{\exp_{p_0}Z}-\cost{{p_0}}{\exp_{p_0}Z}.\]
Note that $h_0\equiv 0$; in particular 
\[Y\tilde Y_{p_0}h_0=0\]
for any $Y\in\T_q$.

By (\textit{\ref{MTW-plus-convexity:h}}), 
\[Y\tilde Y_{p_0}h_t\le 0.\]
It follows that 
\[\frac{d^2}{dt^2}(Y\tilde Y_{p_0}h_t)\le 0\]
at $t=0$.
Finally note that 
\[\dcost{X\tilde X_{p_0}}{Y\tilde Y_{p_0}}{p_0}{q}=\frac{d^2}{dt^2}(Y\tilde Y_{p_0}h_t);\]
hence the part (\textit{\ref{MTW-plus-convexity:h}}) follows.
\qeds

